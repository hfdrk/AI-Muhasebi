{"numTotalTestSuites":48,"numPassedTestSuites":45,"numFailedTestSuites":3,"numPendingTestSuites":0,"numTotalTests":56,"numPassedTests":54,"numFailedTests":2,"numPendingTests":0,"numTodoTests":0,"startTime":1764996837347,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["","Auth & Tenant Flow Integration Tests","POST /api/v1/auth/register"],"fullName":" Auth & Tenant Flow Integration Tests POST /api/v1/auth/register should create User, Tenant, and UserTenantMembership with TenantOwner role","status":"passed","title":"should create User, Tenant, and UserTenantMembership with TenantOwner role","duration":4117,"failureMessages":[]},{"ancestorTitles":["","Auth & Tenant Flow Integration Tests","POST /api/v1/auth/register"],"fullName":" Auth & Tenant Flow Integration Tests POST /api/v1/auth/register should fail with duplicate email","status":"passed","title":"should fail with duplicate email","duration":2477,"failureMessages":[]},{"ancestorTitles":["","Auth & Tenant Flow Integration Tests","POST /api/v1/auth/register"],"fullName":" Auth & Tenant Flow Integration Tests POST /api/v1/auth/register should fail with duplicate tenant slug","status":"passed","title":"should fail with duplicate tenant slug","duration":2455,"failureMessages":[]},{"ancestorTitles":["","Auth & Tenant Flow Integration Tests","POST /api/v1/auth/login"],"fullName":" Auth & Tenant Flow Integration Tests POST /api/v1/auth/login should succeed with correct credentials","status":"passed","title":"should succeed with correct credentials","duration":3030,"failureMessages":[]},{"ancestorTitles":["","Auth & Tenant Flow Integration Tests","POST /api/v1/auth/login"],"fullName":" Auth & Tenant Flow Integration Tests POST /api/v1/auth/login should fail with wrong password","status":"passed","title":"should fail with wrong password","duration":2607,"failureMessages":[]},{"ancestorTitles":["","Auth & Tenant Flow Integration Tests","POST /api/v1/auth/login"],"fullName":" Auth & Tenant Flow Integration Tests POST /api/v1/auth/login should fail with non-existent email","status":"passed","title":"should fail with non-existent email","duration":3379,"failureMessages":[]},{"ancestorTitles":["","Auth & Tenant Flow Integration Tests","Tenant Isolation"],"fullName":" Auth & Tenant Flow Integration Tests Tenant Isolation should prevent user from Tenant A accessing Tenant B's data","status":"passed","title":"should prevent user from Tenant A accessing Tenant B's data","duration":2686,"failureMessages":[]}],"startTime":1764996842136,"endTime":1764996862887,"status":"passed","message":"","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/routes/__tests__/auth-routes.integration.test.ts"},{"assertionResults":[],"startTime":1764996837347,"endTime":1764996837347,"status":"failed","message":"Transform failed with 1 error:\n/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/routes/__tests__/core-domain.integration.test.ts:70:12: ERROR: The symbol \"prisma\" has already been declared","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/routes/__tests__/core-domain.integration.test.ts"},{"assertionResults":[],"startTime":1764996837347,"endTime":1764996837347,"status":"failed","message":"Transform failed with 1 error:\n/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/routes/__tests__/documents.integration.test.ts:62:12: ERROR: The symbol \"prisma\" has already been declared","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/routes/__tests__/documents.integration.test.ts"},{"assertionResults":[],"startTime":1764996837347,"endTime":1764996837347,"status":"failed","message":"Transform failed with 1 error:\n/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/routes/__tests__/integrations.integration.test.ts:53:10: ERROR: The symbol \"prisma\" has already been declared","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/routes/__tests__/integrations.integration.test.ts"},{"assertionResults":[{"ancestorTitles":["","RBAC Integration Tests","POST /api/v1/tenants/:tenantId/users/invite"],"fullName":" RBAC Integration Tests POST /api/v1/tenants/:tenantId/users/invite should allow TenantOwner to invite users","status":"failed","title":"should allow TenantOwner to invite users","duration":9367,"failureMessages":["Failed to get auth token: E-posta veya şifre hatalı."],"location":{"line":193,"column":15}},{"ancestorTitles":["","RBAC Integration Tests","POST /api/v1/tenants/:tenantId/users/invite"],"fullName":" RBAC Integration Tests POST /api/v1/tenants/:tenantId/users/invite should allow Accountant to invite users","status":"passed","title":"should allow Accountant to invite users","duration":3669,"failureMessages":[]},{"ancestorTitles":["","RBAC Integration Tests","POST /api/v1/tenants/:tenantId/users/invite"],"fullName":" RBAC Integration Tests POST /api/v1/tenants/:tenantId/users/invite should deny ReadOnly user from inviting users","status":"passed","title":"should deny ReadOnly user from inviting users","duration":3169,"failureMessages":[]},{"ancestorTitles":["","RBAC Integration Tests","POST /api/v1/tenants/:tenantId/users/invite"],"fullName":" RBAC Integration Tests POST /api/v1/tenants/:tenantId/users/invite should deny Staff user from inviting users","status":"passed","title":"should deny Staff user from inviting users","duration":3633,"failureMessages":[]},{"ancestorTitles":["","RBAC Integration Tests","GET /api/v1/tenants/:tenantId/users"],"fullName":" RBAC Integration Tests GET /api/v1/tenants/:tenantId/users should allow all roles to read users list","status":"passed","title":"should allow all roles to read users list","duration":4300,"failureMessages":[]},{"ancestorTitles":["","RBAC Integration Tests","Document operations"],"fullName":" RBAC Integration Tests Document operations should allow TenantOwner to create documents","status":"passed","title":"should allow TenantOwner to create documents","duration":2743,"failureMessages":[]},{"ancestorTitles":["","RBAC Integration Tests","Document operations"],"fullName":" RBAC Integration Tests Document operations should deny ReadOnly user from creating documents","status":"passed","title":"should deny ReadOnly user from creating documents","duration":2944,"failureMessages":[]}],"startTime":1764996864640,"endTime":1764996894466,"status":"failed","message":"","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/routes/__tests__/rbac.integration.test.ts"},{"assertionResults":[{"ancestorTitles":["","AI Pipeline & Risk Features Integration Tests","OCR Service"],"fullName":" AI Pipeline & Risk Features Integration Tests OCR Service should return non-empty raw_text and engineName for PDF file","status":"passed","title":"should return non-empty raw_text and engineName for PDF file","duration":1965,"failureMessages":[]},{"ancestorTitles":["","AI Pipeline & Risk Features Integration Tests","OCR Service"],"fullName":" AI Pipeline & Risk Features Integration Tests OCR Service should return non-empty raw_text and engineName for image file","status":"passed","title":"should return non-empty raw_text and engineName for image file","duration":1591,"failureMessages":[]},{"ancestorTitles":["","AI Pipeline & Risk Features Integration Tests","Document Parser Service"],"fullName":" AI Pipeline & Risk Features Integration Tests Document Parser Service should parse OCR text for invoice type and return structured data","status":"passed","title":"should parse OCR text for invoice type and return structured data","duration":1738,"failureMessages":[]},{"ancestorTitles":["","AI Pipeline & Risk Features Integration Tests","Document Parser Service"],"fullName":" AI Pipeline & Risk Features Integration Tests Document Parser Service should parse OCR text for bank statement type","status":"passed","title":"should parse OCR text for bank statement type","duration":1684,"failureMessages":[]},{"ancestorTitles":["","AI Pipeline & Risk Features Integration Tests","Risk Feature Service"],"fullName":" AI Pipeline & Risk Features Integration Tests Risk Feature Service should generate risk features with DUE_BEFORE_ISSUE flag when due_date < issue_date","status":"passed","title":"should generate risk features with DUE_BEFORE_ISSUE flag when due_date < issue_date","duration":1517,"failureMessages":[]},{"ancestorTitles":["","AI Pipeline & Risk Features Integration Tests","Risk Feature Service"],"fullName":" AI Pipeline & Risk Features Integration Tests Risk Feature Service should generate risk features with DUPLICATE_INVOICE_NUMBER flag","status":"passed","title":"should generate risk features with DUPLICATE_INVOICE_NUMBER flag","duration":1306,"failureMessages":[]}],"startTime":1764996862950,"endTime":1764996872752,"status":"passed","message":"","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/services/__tests__/ai-pipeline.integration.test.ts"},{"assertionResults":[{"ancestorTitles":["","ClientCompanyService","listClientCompanies"],"fullName":" ClientCompanyService listClientCompanies should return paginated list of client companies for a tenant","status":"passed","title":"should return paginated list of client companies for a tenant","duration":622,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","listClientCompanies"],"fullName":" ClientCompanyService listClientCompanies should filter by isActive when provided","status":"passed","title":"should filter by isActive when provided","duration":1,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","listClientCompanies"],"fullName":" ClientCompanyService listClientCompanies should search by name or tax number when search filter is provided","status":"passed","title":"should search by name or tax number when search filter is provided","duration":1,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","getClientCompanyById"],"fullName":" ClientCompanyService getClientCompanyById should return client company with stats when found","status":"passed","title":"should return client company with stats when found","duration":1,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","getClientCompanyById"],"fullName":" ClientCompanyService getClientCompanyById should throw NotFoundError when client company not found","status":"passed","title":"should throw NotFoundError when client company not found","duration":2,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","createClientCompany"],"fullName":" ClientCompanyService createClientCompany should create a new client company","status":"passed","title":"should create a new client company","duration":1,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","createClientCompany"],"fullName":" ClientCompanyService createClientCompany should throw ValidationError when tax number already exists","status":"passed","title":"should throw ValidationError when tax number already exists","duration":1,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","updateClientCompany"],"fullName":" ClientCompanyService updateClientCompany should update an existing client company","status":"passed","title":"should update an existing client company","duration":0,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","updateClientCompany"],"fullName":" ClientCompanyService updateClientCompany should throw NotFoundError when client company not found","status":"passed","title":"should throw NotFoundError when client company not found","duration":1,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","deleteClientCompany"],"fullName":" ClientCompanyService deleteClientCompany should delete an existing client company","status":"passed","title":"should delete an existing client company","duration":1,"failureMessages":[]},{"ancestorTitles":["","ClientCompanyService","deleteClientCompany"],"fullName":" ClientCompanyService deleteClientCompany should throw NotFoundError when client company not found","status":"passed","title":"should throw NotFoundError when client company not found","duration":1,"failureMessages":[]}],"startTime":1764996863314,"endTime":1764996863946,"status":"passed","message":"","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/services/__tests__/client-company-service.test.ts"},{"assertionResults":[{"ancestorTitles":["","DocumentAIService","getDocumentAIAnalysis"],"fullName":" DocumentAIService getDocumentAIAnalysis should return AI analysis for a document","status":"passed","title":"should return AI analysis for a document","duration":602,"failureMessages":[]},{"ancestorTitles":["","DocumentAIService","getDocumentAIAnalysis"],"fullName":" DocumentAIService getDocumentAIAnalysis should throw NotFoundError when document not found","status":"passed","title":"should throw NotFoundError when document not found","duration":2,"failureMessages":[]},{"ancestorTitles":["","DocumentAIService","getDocumentAIAnalysis"],"fullName":" DocumentAIService getDocumentAIAnalysis should enforce tenant isolation","status":"passed","title":"should enforce tenant isolation","duration":0,"failureMessages":[]},{"ancestorTitles":["","DocumentAIService","getDocumentAIAnalysis"],"fullName":" DocumentAIService getDocumentAIAnalysis should return null for missing AI results","status":"passed","title":"should return null for missing AI results","duration":1,"failureMessages":[]}],"startTime":1764996894956,"endTime":1764996895561,"status":"passed","message":"","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/services/__tests__/document-ai-service.test.ts"},{"assertionResults":[{"ancestorTitles":["","DocumentService","uploadDocument"],"fullName":" DocumentService uploadDocument should upload a document successfully","status":"passed","title":"should upload a document successfully","duration":595,"failureMessages":[]},{"ancestorTitles":["","DocumentService","uploadDocument"],"fullName":" DocumentService uploadDocument should throw ValidationError when client company doesn't belong to tenant","status":"passed","title":"should throw ValidationError when client company doesn't belong to tenant","duration":1,"failureMessages":[]},{"ancestorTitles":["","DocumentService","uploadDocument"],"fullName":" DocumentService uploadDocument should throw ValidationError when file size exceeds limit","status":"passed","title":"should throw ValidationError when file size exceeds limit","duration":1,"failureMessages":[]},{"ancestorTitles":["","DocumentService","listDocuments"],"fullName":" DocumentService listDocuments should return paginated list of documents for a tenant","status":"passed","title":"should return paginated list of documents for a tenant","duration":4,"failureMessages":[]},{"ancestorTitles":["","DocumentService","getDocumentById"],"fullName":" DocumentService getDocumentById should return document with extracted data when found","status":"passed","title":"should return document with extracted data when found","duration":0,"failureMessages":[]},{"ancestorTitles":["","DocumentService","getDocumentById"],"fullName":" DocumentService getDocumentById should throw NotFoundError when document not found","status":"passed","title":"should throw NotFoundError when document not found","duration":1,"failureMessages":[]},{"ancestorTitles":["","DocumentService","deleteDocument"],"fullName":" DocumentService deleteDocument should soft delete a document","status":"passed","title":"should soft delete a document","duration":1,"failureMessages":[]}],"startTime":1764996873119,"endTime":1764996873723,"status":"passed","message":"","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/services/__tests__/document-service.test.ts"},{"assertionResults":[{"ancestorTitles":["","InvoiceService","createInvoice"],"fullName":" InvoiceService createInvoice should create an invoice with lines","status":"passed","title":"should create an invoice with lines","duration":777,"failureMessages":[]},{"ancestorTitles":["","InvoiceService","createInvoice"],"fullName":" InvoiceService createInvoice should throw ValidationError when client company doesn't belong to tenant","status":"passed","title":"should throw ValidationError when client company doesn't belong to tenant","duration":2,"failureMessages":[]},{"ancestorTitles":["","InvoiceService","updateInvoiceStatus"],"fullName":" InvoiceService updateInvoiceStatus should update invoice status","status":"passed","title":"should update invoice status","duration":1,"failureMessages":[]},{"ancestorTitles":["","InvoiceService","updateInvoiceStatus"],"fullName":" InvoiceService updateInvoiceStatus should throw NotFoundError when invoice not found","status":"passed","title":"should throw NotFoundError when invoice not found","duration":1,"failureMessages":[]},{"ancestorTitles":["","InvoiceService","listInvoices"],"fullName":" InvoiceService listInvoices should return paginated list of invoices for a tenant","status":"passed","title":"should return paginated list of invoices for a tenant","duration":1,"failureMessages":[]}],"startTime":1764996874647,"endTime":1764996875429,"status":"passed","message":"","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/services/__tests__/invoice-service.test.ts"},{"assertionResults":[{"ancestorTitles":["","Risk Engine & Alerts Integration Tests","Document Risk Scoring"],"fullName":" Risk Engine & Alerts Integration Tests Document Risk Scoring should compute risk score with severity and triggered rule codes","status":"failed","title":"should compute risk score with severity and triggered rule codes","duration":9677,"failureMessages":["Tenant cmittjuig0001ch7esvbefpkp not found"],"location":{"line":140,"column":19}},{"ancestorTitles":["","Risk Engine & Alerts Integration Tests","Company Risk Scoring"],"fullName":" Risk Engine & Alerts Integration Tests Company Risk Scoring should generate ClientCompanyRiskScore with correct severity","status":"passed","title":"should generate ClientCompanyRiskScore with correct severity","duration":2911,"failureMessages":[]},{"ancestorTitles":["","Risk Engine & Alerts Integration Tests","Risk Alerts"],"fullName":" Risk Engine & Alerts Integration Tests Risk Alerts should create RiskAlert for high-risk document","status":"passed","title":"should create RiskAlert for high-risk document","duration":3840,"failureMessages":[]},{"ancestorTitles":["","Risk Engine & Alerts Integration Tests","Risk Alerts"],"fullName":" Risk Engine & Alerts Integration Tests Risk Alerts should create RiskAlert for high-risk company","status":"passed","title":"should create RiskAlert for high-risk company","duration":2615,"failureMessages":[]}],"startTime":1764996842130,"endTime":1764996861174,"status":"failed","message":"","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/services/__tests__/risk-engine.integration.test.ts"},{"assertionResults":[{"ancestorTitles":["","TransactionService","createTransaction"],"fullName":" TransactionService createTransaction should create a transaction with balanced debit and credit","status":"passed","title":"should create a transaction with balanced debit and credit","duration":600,"failureMessages":[]},{"ancestorTitles":["","TransactionService","createTransaction"],"fullName":" TransactionService createTransaction should throw ValidationError when debit and credit totals don't match","status":"passed","title":"should throw ValidationError when debit and credit totals don't match","duration":1,"failureMessages":[]},{"ancestorTitles":["","TransactionService","createTransaction"],"fullName":" TransactionService createTransaction should throw ValidationError when transaction has less than 2 lines","status":"passed","title":"should throw ValidationError when transaction has less than 2 lines","duration":1,"failureMessages":[]},{"ancestorTitles":["","TransactionService","listTransactions"],"fullName":" TransactionService listTransactions should return paginated list of transactions for a tenant","status":"passed","title":"should return paginated list of transactions for a tenant","duration":2,"failureMessages":[]},{"ancestorTitles":["","TransactionService","listTransactions"],"fullName":" TransactionService listTransactions should filter by client company when provided","status":"passed","title":"should filter by client company when provided","duration":1,"failureMessages":[]}],"startTime":1764996861689,"endTime":1764996862294,"status":"passed","message":"","name":"/Users/md/Desktop/MyProjects-2025/AI Muhasebi/AI-Muhasebi/apps/backend-api/src/services/__tests__/transaction-service.test.ts"}]}